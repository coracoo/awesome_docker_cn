>ä½œè€…ï¼šå¯çˆ±çš„å°cherry
>
>å…¬ä¼—å·ï¼šå¯çˆ±çš„å°cherry
>
![image.png](https://cgakki.top/wp-content/uploads/2024/04/qrcode_for_gh_d5083129ff7e_258.jpg)

# å‰è¨€

å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯å¯çˆ±çš„Cherryã€‚

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŒ…å«**æœåŠ¡ç«¯ã€webç«¯ã€ç§»åŠ¨ç«¯** ä¸‰ç«¯é½å…¨çš„**åŠ å¯†å­˜å‚¨é¡¹ç›®** ï¼ŒåŒ…æ‹¬**authï¼ˆå­˜å‚¨2FAï¼‰** å’Œ**photoï¼ˆå­˜å‚¨ç…§ç‰‡ï¼‰** ä¸¤ä¸ªå­é¡¹ç›®ï¼Œæ‰€æœ‰ä»£ç å®Œå…¨å¼€æºï¼Œé‡‡ç”¨AGPL-3.0å¼€æºåè®®ã€‚

è¯¥é¡¹ç›®photoéƒ¨åˆ†æ˜¯appleå’Œgoogle photosçš„å¼€æºä»£æ›¿å“ï¼Œæ”¯æŒè‡ªæ‰˜ç®¡å’Œå¤–éƒ¨S3å­˜å‚¨ï¼Œä»Šå¤©æˆ‘ä»¬å…ˆä»‹ç»photoéƒ¨åˆ†å¦‚ä½•éƒ¨ç½²å’Œä½¿ç”¨ï¼Œè€ƒè™‘åˆ°å¤§éƒ¨åˆ†ç…§ç‰‡éƒ½åœ¨æ‰‹æœºç«¯ï¼Œæ‰€ä»¥åªä»‹ç»æ‰‹æœºç«¯ä½¿ç”¨ï¼ˆä¸»è¦æ˜¯æ‰‹æœºç«¯æ˜¨å¤©åˆšå…è®¸ä½¿ç”¨è‡ªæ‰˜ç®¡æœåŠ¡ï¼Œä¸éœ€è¦è‡ªå·±ç¼–è¯‘ï¼Œå®åœ¨å¤ªå¥½äº†ï¼‰ã€‚

ğŸ”»Ente Photoâ€”â€”åŠ å¯†ç…§ç‰‡å­˜å‚¨ç®¡ç†

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13951.png)

ğŸ”»Ente Authâ€”â€”åŠ å¯†2FAç®¡ç†

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13952.png)

ğŸ”´ä»¥ä¸‹æ¥è‡ªå®˜æ–¹ä»‹ç»
>Enteæ˜¯ä¸€é¡¹æœåŠ¡ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå®Œå…¨å¼€æºçš„ç«¯åˆ°ç«¯åŠ å¯†å¹³å°ï¼Œæ‚¨å¯ä»¥å°†æ•°æ®å­˜å‚¨åœ¨äº‘ä¸­ï¼Œè€Œæ— éœ€ä¿¡ä»»æœåŠ¡æä¾›å•†ã€‚åœ¨è¿™ä¸ªå¹³å°ä¸Šï¼Œæˆ‘ä»¬å·²ç»æ„å»ºäº†ä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼šEnte Photosï¼ˆAppleå’ŒGoogle Photosçš„æ›¿ä»£å“ï¼‰å’ŒEnte Authï¼ˆå·²å¼ƒç”¨çš„Authyçš„2FAæ›¿ä»£å“ï¼‰ã€‚
>
>é¡¹ç›®åŒ…å«æˆ‘ä»¬æ‰€æœ‰çš„æºä»£ç -å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼ˆiOS / Android / F-Droid / Web / Linux / macOS / Windowsï¼‰çš„äº§å“ï¼ˆå’Œæ›´å¤šçš„è®¡åˆ’æœªæ¥çš„ï¼ï¼‰ï¼Œä»¥åŠä¸ºå…¶æä¾›åŠ¨åŠ›çš„æœåŠ¡å™¨ã€‚æˆ‘ä»¬çš„æºä»£ç å’ŒåŠ å¯†æŠ€æœ¯å·²ç»è¿‡Cure 53ï¼ˆä¸€å®¶å¾·å›½ç½‘ç»œå®‰å…¨å…¬å¸ï¼Œå¯ä»¥è¯´æ˜¯ä¸–ç•Œä¸Šæœ€å¥½ï¼‰ï¼ŒSymbolic Softwareï¼ˆæ³•å›½åŠ å¯†ä¸“å®¶ï¼‰å’ŒFallibleï¼ˆä¸€å®¶å°åº¦æ¸—é€æµ‹è¯•å…¬å¸ï¼‰çš„å¤–éƒ¨å®¡è®¡ã€‚

---

# ç³»ç»Ÿæ•ˆæœ
ğŸ”»appç«¯æ”¯æŒæŒ‰æ‰‹æœºç›¸å†Œè¿›è¡Œå¤‡ä»½ï¼Œå…è®¸å¯¹å·²å¤‡ä»½çš„ç›¸å†Œè¿›è¡Œä¸€é”®é‡Šæ”¾ç©ºé—´ï¼Œå…è®¸ç§»é™¤é‡å¤å†…å®¹ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13953.png)

ğŸ”»ä»å®‰å…¨è§’åº¦å‡ºå‘ï¼Œå…è®¸ç®¡ç†å¯†é’¥ã€è®¾ç½®2FAè®¤è¯ã€è®¾ç½®ç”µå­é‚®ä»¶ç™»å½•è®¤è¯ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13954.png)

ğŸ”»ä»åŠŸèƒ½è§’åº¦ï¼Œæ”¯æŒæŒ‰ç›¸å†Œç®¡ç†ç…§ç‰‡ï¼Œæ”¯æŒåˆ†äº«ç…§ç‰‡ï¼Œæ”¯æŒè®¾å®šæ´»åŠ¨ç…§ç‰‡ç”¨äºå…¶ä»–äººä¸Šä¼ ç…§ç‰‡ï¼Œæ”¯æŒæŒ‰åœ°å›¾ã€æ—¶é—´ã€ç›¸å†Œè¿›è¡Œç…§ç‰‡æ£€ç´¢

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13955.png)

ğŸ”»é«˜çº§è®¾ç½®ï¼Œå¯ä»¥è®¾ç½®æœºå™¨å­¦ä¹ ï¼ˆclipï¼‰ï¼Œå…·ä½“çš„clipæ¨¡å‹ä¸å¾—è€ŒçŸ¥ã€‚ä½†æ˜¯åœ¨æ£€ç´¢ä¸Šï¼Œå¯ä»¥çœ‹åˆ°è‹±æ–‡æ£€ç´¢å‡†ç¡®å®šè¿˜æ˜¯ä¸é”™çš„ï¼Œè€Œä¸­æ–‡æ£€ç´¢èƒ½åŠ›è¦å¼±å¾ˆå¤šã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13956.png)

---

# ç³»ç»Ÿéƒ¨ç½²ï¼ˆPhotoæœåŠ¡ç«¯ï¼‰

## ä¸€ã€å‰æœŸå‡†å¤‡

```
# ä»¥ä¸‹å‘½ä»¤é€è¡Œè¾“å…¥
mkdir ente && cd ente 
# ä¸‹è½½compose.yaml
curl -LO https://raw.gitmirror.com/ente-io/ente/main/server/compose.yaml

# ä¸‹è½½credentials.yamlå’Œminio-provision.shæ–‡ä»¶
mkdir -p scripts/compose && cd scripts/compose
curl -LO https://raw.gitmirror.com/ente-io/ente/main/server/scripts/compose/credentials.yaml
curl -LO https://raw.gitmirror.com/ente-io/ente/main/server/scripts/compose/minio-provision.sh
```

## äºŒã€ä¿®æ”¹é…ç½®æ–‡ä»¶

1ï¸âƒ£ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹docker-compose.yaml

ğŸ”»ç¬¬ä¸€ä¸ªå¯ä»¥ä¿®æ”¹çš„åœ°æ–¹æ˜¯ç«¯å£ï¼Œä¸»è¦ä¿®æ”¹8080è¿™ä¸ªAPIæ¥å£å°±è¡Œäº†ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13957.png)

ğŸ”»ç¬¬äºŒä¸ªå¯ä»¥ä¿®æ”¹çš„åœ°æ–¹æ˜¯é•œåƒï¼Œå°†`docker build`å†…å®¹æ”¹ä¸º`image: ghcr.io/ente-io/server`

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13958.pngg)

![image.png](https://cgakki.top/wp-content/uploads/2024/04/13959.pngg)

ğŸ”»ç¬¬ä¸‰ä¸ªå¯ä»¥ä¿®æ”¹çš„æ˜¯postgreså’Œminioçš„ç«¯å£ã€‚

å¦‚æœminioçš„æ”¹äº†ã€‚minio-provision.shä¹Ÿè¦å¯¹åº”ä¿®æ”¹ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139510.png)

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139511.png)

2ï¸âƒ£ä¿®æ”¹`credentials.yaml`æ–‡ä»¶ã€‚è·¯å¾„åœ¨`ente/scripts/compose/credentials.yaml`ï¼Œè¿™ä¸‰ä¸ª`endpoint`å¿…é¡»æ˜¯æœåŠ¡å™¨ç«¯å’Œæ‰‹æœºç«¯éƒ½å¯ä»¥è®¿é—®åˆ°çš„åœ°å€ï¼Œå¦‚æœæ˜¯å±€åŸŸç½‘å°±æ˜¯å¡«å®¿ä¸»æœºipï¼Œå¦‚æœæ˜¯å¤–ç½‘å°±å¡«å¤–ç½‘ipæˆ–åŸŸåã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139512.png)

## ä¸‰ã€SSHéƒ¨ç½²

```
#æ¥åˆ°æ–‡ä»¶å¤¹
cd /volume1/docker/ente
#å¯åŠ¨å®¹å™¨
docker-compose up -d
```

## å››ã€ç¾¤æ™–éƒ¨ç½²
ğŸ”»æ‰“å¼€container managerï¼Œé€‰æ‹©é¡¹ç›®ï¼Œç‚¹å‡»æ–°å»ºï¼Œé€‰æ‹©penpotè·¯å¾„ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥å³å¯

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139513.png)

## äº”ã€å¨è”é€šéƒ¨ç½²

ğŸ”»æ‰“å¼€container stationï¼Œåˆ›å»ºåº”ç”¨ç¨‹åºï¼Œå¤åˆ¶ä»£ç éªŒè¯åéƒ¨ç½²å³å¯

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139514.png)

---

# ç³»ç»Ÿéƒ¨ç½²ï¼ˆwebç«¯ï¼‰

ğŸ”»è¯¥é¡¹ç›®çš„webç«¯ç›®å‰æ²¡æœ‰æä¾›imageï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±ä½¿ç”¨docekrfileï¼Œå› æ­¤è¿™é‡Œå°±æŠŠissuseé‡Œçš„dockerfileæä¾›å‡ºæ¥ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±docker buildã€‚

```
FROM node:20-alpine as builder

WORKDIR /app
COPY . .

ARG NEXT_PUBLIC_ENTE_ENDPOINT=http://localhost:8080  #è¿™é‡Œéœ€è¦æ›´æ”¹ä¸ºä½ è‡ªå·±çš„æœåŠ¡å™¨åœ°å€
ENV NEXT_PUBLIC_ENTE_ENDPOINT=${NEXT_PUBLIC_ENTE_ENDPOINT}

RUN yarn install && yarn build

FROM node:20-alpine

WORKDIR /app
COPY --from=builder /app/apps/photos/out .

RUN npm install -g serve

ENV PORT=3000
EXPOSE ${PORT}

CMD serve -s . -l tcp://0.0.0.0:${PORT}
```

ğŸ”»å½“ç„¶ï¼Œå¦‚æœæœåŠ¡å™¨ä¸Šè£…æœ‰npmçš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨yarnå®‰è£…ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†NASåº”è¯¥éƒ½ä¸æ”¯æŒï¼Œå»ºè®®ä¸è¦æŠ˜è…¾ã€‚

```
cd ente/web
git submodule update --init --recursive
yarn install
NEXT_PUBLIC_ENTE_ENDPOINT=http://localhost:8080 yarn dev
```

---
# ç³»ç»Ÿéƒ¨ç½²ï¼ˆAPPç«¯ï¼‰

# ä¸€ã€ä¸‹è½½app

photoå®‰å“APPä¸‹è½½åœ°å€ï¼šhttps://github.com/ente-io/ente/releases/download/photos-v0.8.70/ente-photos-v0.8.70.apk

photoè‹¹æœAPPä¸‹è½½åœ°å€ï¼šç›´æ¥å›½æœå•†åº—ä¸‹è½½

## äºŒã€è¿æ¥è‡ªæ‰˜ç®¡æœåŠ¡ï¼Œå¹¶åˆ›å»ºè´¦å·

ğŸ”»æ‰“å¼€APPä»¥åï¼Œè¿ç»­ç‚¹å‡»ä¸­é—´çš„å›¾æ ‡7ä¸‹ï¼Œè§£é”è‡ªæ‰˜ç®¡æ¨¡å¼ã€‚ç‚¹å‡»YESï¼Œç„¶ååœ¨å¼¹æ¡†ä¸­è¾“å…¥è‡ªæ‰˜ç®¡çš„æœåŠ¡åœ°å€ï¼Œå¦‚ `http://192.168.0.2:56789`ï¼Œç„¶åç‚¹å‡»`New to ente`å¼€å§‹è®¾ç½®è´¦å·ã€‚ 

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139515.png)

## ä¸‰ã€æŸ¥çœ‹æ—¥å¿—ï¼Œè¿›è¡Œè´¦å·é‚®ä»¶éªŒè¯ç 

ğŸ”»å½“åˆ›å»ºè´¦å·ä»¥åï¼Œä¼šæœ‰ä¸€ä¸ªé‚®ç®±éªŒè¯ç ï¼Œè¿™ä¸ªéªŒè¯ç ç›®å‰å®˜æ–¹å¹¶æ²¡æœ‰ç»™å‡ºé‚®ä»¶é€šé“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨åå°æŸ¥çœ‹ã€‚

```
# æ¥åˆ°enteç›®å½•ï¼ŒæŸ¥çœ‹æ—¥å¿—
cd /volume1/docker/ente
docker-compose logs -f
```

ğŸ”»åœ¨è·å–æ—¥å¿—çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¸€ä¸²éªŒè¯ç ï¼Œæœ€åçš„814763å°±æ˜¯æœ¬æ¬¡é‚®ç®±éªŒè¯ç ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„æ—¥å¿—æŸ¥çœ‹ä¸è¦å…³ï¼Œä¸€ä¼šæˆ‘ä»¬è¿˜è¦ç”¨åˆ°ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139516.png)

ğŸ”»è¿™é‡Œè¾“å…¥éªŒè¯ç å³å¯

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139517.png)

## å››ã€è®¾ç½®ä¸­æ–‡

ğŸ”»è¯¥é¡¹ç›®æ”¯æŒä¸­æ–‡ï¼Œæœ‰æ²¡æœ‰æ„Ÿè§‰å¾ˆæ£’ï¼é€‰æ‹©`gerneral`-`language`-'ä¸­æ–‡'å³å¯

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139518.png)

## äº”ã€æ‰©å®¹å­˜å‚¨ç©ºé—´

ğŸ”»é¦–æ¬¡ç™»å½•ç³»ç»Ÿï¼Œæˆ‘ä»¬åªæœ‰1Gçš„å­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥çœ‹åˆ°å®˜æ–¹æç¤ºå¯ä»¥é€šè¿‡é‚€è¯·ã€è´­ä¹°æ¥è¿›è¡Œæ‰©å®¹ï¼Œè¿™ä¹Ÿè¡¨ç¤ºè¯¥é¡¹ç›®å¯ä»¥ç”¨äºå•†ç”¨ï¼ˆå…·ä½“çœ‹å¼€æºåè®®ï¼Œå˜¿å˜¿ï¼‰ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139519.png)

ğŸ”»å¼€å§‹æ‰©å®¹ï¼Œç»§ç»­çœ‹æˆ‘ä»¬çš„æ—¥å¿—ï¼Œæ‰¾åˆ°åˆ›å»ºç”¨æˆ·çš„ç”¨æˆ·IDï¼ŒåŸºæœ¬ä¸Šæ¯ä¸€æ¡æ—¥å¿—éƒ½æœ‰è·Ÿä¸€ä¸ª`user_id`ï¼Œæˆ‘ä»¬åªè¦æ‰¾åˆ°å¹¶å¤åˆ¶è¿™ä¸ª`user_id`å³å¯ï¼Œæˆ‘è¿™é‡Œæ˜¯`user_id=1580559962386438`

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139520.png)

ğŸ”»æŒ‰`ctrl+c`å…³é—­æ—¥å¿—ï¼Œé‡å›SSHæŒ‡ä»¤ç•Œé¢ï¼Œè¾“å…¥ä»¥åæŒ‡ä»¤

```
# æŠŠã€user_idã€‘æ›¿æ¢æˆè‡ªå·±çš„IDï¼Œ1580559962386438
docker-compose exec -i postgres psql -U pguser -d ente_db -c "INSERT INTO storage_bonus (bonus_id, user_id, storage, type, valid_till) VALUES ('self-hosted-myself', (SELECT user_id FROM users LIMIT 1), ã€user_idã€‘, 'ADD_ON_SUPPORT', 0)"
```

ğŸ”»è¿”å›ç»“æœ`INSERT 0 1`ï¼Œè¡¨ç¤ºæ›´æ”¹æˆåŠŸ

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139521.png)

ğŸ”»å›åˆ°æˆ‘ä»¬çš„æ‰‹æœºAPPï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå­˜å‚¨ç©ºé—´å·²ç»å˜æˆ2Täº†ï¼Œå¦‚æœæ²¡å˜ç­‰åˆ·æ–°ä¸€ä¸‹å³å¯ã€‚

![image.png](https://cgakki.top/wp-content/uploads/2024/04/139522.png)
